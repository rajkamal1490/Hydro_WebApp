<md-dialog flex="70" style="left: 7%" ng-init="vm.loadinitial()"> 
  <form name="vm.taskForm" novalidate autocomplete="off">
    <div class="modal-header bg-primary">
      <h4>{{vm.task._id ? 'Edit task' : 'Create task'}}</h4>
    </div>
       <md-dialog-content style="padding-left: 24px">         
          <div class="col-md-12 col-sm-12 col-xs-12">
            <div layout="row" flex>
              <md-input-container flex>
                <label class="my-label">Title</label>
                <input required type="text" name="title" ng-model="vm.task.title"/>
                <div ng-messages="vm.taskForm.title.$error">
                  <div ng-message="required">Title is required.</div>
                </div>
              </md-input-container>

              <md-input-container flex>
                  <label class="my-label">Description</label>
                  <input required type="text" name="description" ng-model="vm.task.description"/>
                  <div ng-messages="vm.taskForm.description.$error">
                    <div ng-message="required">Description is required.</div>
                  </div>
              </md-input-container>
            </div>

            <div layout="row" flex>
            
              <md-input-container flex>
                <label class="my-label"><b>Start Date</b></label>
                  <div ng-click="showStartDatePicker($event)">
                    <input style="color: #000066; font-weight: bold;" required name="start" ng-model="vm.task.startDateTime" onfocus="this.blur()" readonly></input>
                  </div>
                  <div ng-messages="vm.taskForm.start.$error">
                    <div ng-message="required">Start date is required.</div>
                    <div ng-message="lesser">Event start date should be before the end date.</div>
                  </div>
              </md-input-container>

              <md-input-container flex>
                <label class="my-label"><b>Due Date</b></label>
                  <div ng-click="showEndDatePicker($event)">
                    <input style="color: #000066; font-weight: bold;" required name="end" ng-model="vm.task.dueDateTime" onfocus="this.blur()" readonly></input>
                  </div>
                  <div ng-messages="vm.taskForm.end.$error">
                    <div ng-message="required">End date is required.</div>
                    <div ng-message="greater">Event end date should be after the start date.</div>
                  </div>
              </md-input-container>
            </div>
            <div layout="row" flex>                       
               
              <md-input-container flex>
                <label class="my-label">Priority</label>               
                <md-select
                        required
                        name="priority"
                        ng-model="vm.task.priority">
                  <md-optgroup label="Priority">
                    <md-option ng-value="priority.code" ng-repeat="priority in vm.priorities">{{priority.name}}</md-option>
                  </md-optgroup>
                </md-select>
                <div ng-messages="vm.taskForm.priority.$error">
                    <div ng-message="required">Priority is required.</div>
                </div>
              </md-input-container>           
           
              <md-input-container flex>
                <label class="my-label">Assignee:</label>
                <md-select
                      required
                      name="assignee"
                      ng-model="vm.task.assignee">
                  <md-optgroup label="Assignee">
                    <md-option  ng-value="user._id" ng-repeat="user in model.users">{{user.displayName}}</md-option>
                  </md-optgroup>
                </md-select>
                <div ng-messages="vm.taskForm.assignee.$error">
                    <div ng-message="required">Assignee is required.</div>
                </div>
              </md-input-container>
             </div>
             <div layout="row" flex ng-if="vm.authentication.user._id === vm.task.assignee && ui.editMode">               
              <md-input-container flex>
                <label class="my-label">Status</label>               
                <md-select                        
                        name="status"
                        ng-model="vm.task.status">
                  <md-optgroup label="Status">
                    <md-option ng-value="status.code" ng-repeat="status in vm.statuses">{{status.name}}</md-option>
                  </md-optgroup>
                </md-select>
              </md-input-container>
             </div>

          </div>
      </md-dialog-content>
     <md-dialog-actions layout="row">  
        <span flex></span>
        <md-button class="btn btn-next btn-fill btn-success btn-wd"  ng-hide="ui.isTaskInProgress" flex ng-click="vm.save(vm.taskForm.$valid)" type="submit">{{vm.task._id ? 'Update' : 'Create'}}</md-button>
        <md-button class="btn btn-next btn-fill btn-success btn-wd"  ng-disabled="true" flex ng-show="ui.isTaskInProgress" type="submit"><i class="fa fa-spinner fa-spin"></i> {{vm.task._id ? 'Updating' : 'Creating'}}</md-button>
        <span flex></span>
        <!-- <md-button class="btn btn-next btn-fill btn-danger btn-wd" ng-show="ui.editMode" flex ng-click="deletetask()" type="submit">Delete</md-button> -->
        <span flex></span>
        <md-button class="btn btn-next btn-fill btn-warning btn-wd" flex ng-click="vm.cancel()" type="submit">Cancel</md-button>
        <span flex></span>
      </md-dialog-actions>   
  </form>
</md-dialog>
